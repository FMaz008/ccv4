<script type="text/javascript">
//<!--
	validate = function(){
		
		if($('#page_titre').val()==""){
			alert('Vous devez entrer un titre.');
			return false;
		}
		
		
		//Requête AJAX pour Creer la page
		showplzwait();
                $.ajax({
                    url: '?popup=1&m=Action_Item_SitePagemod',
                    method: 'post',
                    data: 'titre='+encodeURIComponent($('#page_titre').val())+
                            '&content='+encodeURIComponent($('#page_content').val())+
                            '&no='+<?php echo $PAGE->getId();?>+
                            '&user='+$('#header_user').val()+
                            '&pass='+$('#header_pass').val()+
                            '&acces='+$('#acces').prop("checked")+
                            '&showIndex='+$('#showIndex').prop("checked"), 
                    dataType: "html",
                    success: function (data) {
                        operation_confirm(data);
                    }
                });
		return false;
	}

	//Fonction générales

	showplzwait = function(){
		$('#plzwait1').show();
		$('#plzwait2').show();
		$('#request_msgtxt').html("Veuillez patienter...");
		$('#request_msg').hide();
	}
	hideplzwait = function(){
		$('#plzwait1').hide();
		$('#plzwait2').hide();
	}
	operation_confirm = function(rval){
		
		var params=rval.split("|");
		if (params[0]=="OK"){
			hideplzwait();
			$('#perso_pa').html(params[1]);
			goTo(params[2]);
		}else{
			$('#request_msg').show();
			$('#request_msgtxt').html(decodeURIComponent(params[1]));
		}
	}
//-->
</script>
<!-- Zone ombragée -->
<div id="plzwait1" class="plzwait_ombre">&nbsp;</div>
<div id="plzwait2" class="plzwait_content">
	<table style="margin:0 auto;width:300px;height:150px;">
		<tr><td class="title" style="height:10px;">Traitement de la demande</td>
		<tr>
		<td class="name">
			<div id="request_msgtxt">Chargement en cours, veuillez patienter...</div>
			<div id="request_msg" style="display:none;text-align:center;"><br /><a href="#" onclick="hideplzwait();">- Fermer -</a></div>
		</td>
		</tr>
	</tr>
	</table>
</div>



<form id="action_navigateurDomnetModpage" onsubmit="return ajaxSubmitForm(this);">
	
	<center>
		<strong>Modifier la page</strong>
	</center>
	<br />
	<table class="tbl_center">
	<tr>
		<td class="name">Titre</td>
	</tr>
	<tr>
		<td class="value">
			<input type="text" class="text" name="page_titre" size="50" maxlength="250" id="page_titre" value="<?php echo $PAGE->getTitre();?>" />
		</td>
	</tr>
	<tr>
		<td class="name">Contenu [HJ: BBCodes autorisés]</td>
	</tr>
	<tr>
		<td class="value">
			<textarea id="page_content" name="page_content" style="width:600px;height:400px;"><?php echo $PAGE->getContentRaw();?></textarea>
		</td>
	</tr>
	<tr>
		<td class="name">Définition de la visibilité</td>
	</tr>
	<tr>
		<td class="value">
			<table>
			<tr>
				<td class="name">Acc&egrave;s</td>
				<td class="name">Afficher dans l'index</td>
			</tr>
			<tr>
				<td class="value">
					<input type="radio" id="acces" name="acces" value="pub" <?php echo (($PAGE->isPublic()) ? 'CHECKED' : ''); ?> /> Public<br />
					<input type="radio" 			name="acces" value="priv" <?php echo (($PAGE->isPublic()) ? '' : 'CHECKED'); ?> /> Privé
				</td>
				<td class="value">
					<input type="radio" id="showIndex" name="showIndex" value="1" <?php echo (($PAGE->getShowIndex()=='1') ? 'CHECKED' : ''); ?> /> Oui<br />
					<input type="radio"					name="showIndex" value="0" <?php echo (($PAGE->getShowIndex()=='0') ? 'CHECKED' : ''); ?> /> Non (Via URL seulement)
				</td>
			</tr>
			</table>
		</td>
	</tr>
	</table>
	
	<input type="button" class="button" name="create" value="Enregistrer la page !" onclick="validate();" />
</form>
